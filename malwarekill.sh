#!/bin/bash
WORKING=/home/pi/customlist

for i in $(cat $WORKING/hosts/easyhosts)
do
  wget -4 $i -O $WORKING/list/$(basename $i)
  cat $WORKING/list/$(basename $i) >> $WORKING/sorting/malware.txt
  rm -rf $WORKING/list/$(basename $i)
done
sort -u -o $WORKING/sorting/malware-s.txt $WORKING/sorting/malware.txt
for i in $(cat $WORKING/hosts/iphosts)
do
  wget -4 $i -O $WORKING/list/$(basename $i)
  grep -v "^#" $WORKING/list/$(basename $i) | awk -F' ' '{ print $2 }' >> $WORKING/sorting/malware-s.txt
  rm -rf $WORKING/list/$(basename $i)
done
sort -u -o $WORKING/sorting/malware.txt $WORKING/sorting/malware-s.txt
for i in $(cat $WORKING/hosts/headhosts)
do
  wget -4 $i -O $WORKING/list/$(basename $i)
  grep -v "^#" $WORKING/list/$(basename $i) >> $WORKING/sorting/malware.txt
  rm -rf $WORKING/list/$(basename $i)
done
sort -u -o $WORKING/sorting/malware-s.txt $WORKING/sorting/malware.txt
wget -4 https://raw.githubusercontent.com/quidsup/notrack/master/malicious-sites.txt -O $WORKING/list/malicious-sites.txt &&\
  grep -v "^#" $WORKING/list/malicious-sites.txt | awk -F' ' '{ print $1 }' >> $WORKING/sorting/malware-s.txt &&\
  rm -rf $WORKING/list/$(basename $i) &&\
  sort -u -o $WORKING/sorting/malware.txt $WORKING/sorting/malware-s.txt
sed -e '/^ *$/d' $WORKING/sorting/malware.txt | sed 's/\r$//' > $WORKING/sorting/malware-s.txt

cp $WORKING/sorting/malware-s.txt /var/www/html/hosts/malware.txt
chown pi:www-data /var/www/html/hosts/malware.txt
